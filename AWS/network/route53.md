# Route 53
DNS 서비스에서 더 발전된 형태의 GSLB 형태의 서비스이다.
GSLB는 Global Server Load Balancing의 약자로서, 지역에 상관없이 부하를 줄여주는 기능을 제공한다.
주기적으로 연결된 서버들에 헬스 체크가 이루어지기 때문에, 기존 DNS 방식과는 달리 다운된 서버로 사용자가 연결되지 않게 한다.
Route 53은 SLA 100%의 서비스 제공.

## DNS
- `naver.com`과 같은 문자열 주소를 `192.168.0.1`과 같은 IPv4로의 주소 변환이 필요하고, 이를 DNS 서비스라 부름
- DNS서버에는 도메인 주소와 IP주소가 서로 맵핑된다.
- 하나의 행을 레코드라고 부르며, 저장되는 타입에 따라, A 레코드와 CNAME으로 구분

## Record 
- A 레코드 : 도메인 주소와 서버의 IP 주소를직접 맵핑 (`naver.com` - `192.168.0.1`)
    - 한 번의 요청으로 바로 IP 주소를 알 수 있음
    - IP 주소가 자주 바뀌는 경우 번거로움
- CNAME : 도메인 주소를 또 다른 도메인 주소로 맵핑 (`post.blog.co.kr` - `postapi.blog.co.kr`)
    - IP 주소가 자주 바뀌어도 유연하게 대응 가능
    - 실제 IP 주소를 얻을 때까지 여러 번 DNS 정보를 요청하며, 성능 저하의 가능성 존재

### 별칭 레코드
- EC2 : 비별칭 A 레코드
- ELB, CLoudFront, S3 : 별칭 A 레코드
- RDS : 비별칭 CNAME 레코드 

## 라우팅 정책
1. 지연시간 기반 : 각 리전에 대한 latency 정보를 가지고 있어서, 고객 기준으로 가장 latency가 작은 서버와 연결
2. 가중치 기반 : 각 서버로 가는 트래픽의 비율을 조정하여, 특정 서버로 연결될 확률을 조정
3. 지리 위치 라우팅 정책 (Geolocation) : 유저의 지역 정보(사용자 위치 기반)를 기반으로, 미리 설정한 경로로 라우팅 (ex: USA에서 접속하면 us-east-1)
4. 장애조치 라우팅 정책 : 액티브-패시브 장애 조치 구성(재해 복구)에 사용
    - 액티브-액티브 장애 조치 구성이라면 장애조치 라우팅 외에 지연 시간 기반 라우팅 등을 사용함 
5. 지리 근접 라우팅 정책 (Geoproximity) : 리소스의 지리적 위치 기반으로, 사용자와 가장 가까운 리전으로 라우팅
6. 다중값 응답 라우팅 정책 : DNS 쿼리에 무작위로 선택된 최대 8개의 정상 레코드로 응답하게 함. A 레코드를 여러 개 응답하여 로드밸런싱 만듦.
    - 로드 밸런서를 대체하는 것은 아니지만, DNS를 사용하여 가용성 및 로드 밸런싱을 개선함


## Route 53 이 정상적인 레코드를 선택하는 방식
1. 라우팅 정책과 레코드에 대해 지정한 값을 기반으로 선택
2. Route 53이 레코드가 정상이라 확인한 경우
    - 상태 확인이 연결된 비별칭 레코드
    - Evaluate Target Health (대상 상태 평가)가 예로 설정된 별칭 레코드 
3. 레코드가 정상인 경우 IP주소와 같이 해당되는 값으로 쿼리에 응답 / 레코드가 비정상인 경우 다른 레코드 선택하고 정상 레코드를 찾을 때까지 반복
